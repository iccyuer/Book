var storageFlag=function(){if("object"===typeof window.localStorage)try{return localStorage.setItem("localStorageTest",1),localStorage.removeItem("localStorageTest"),!0}catch(a){return!1}else return!1}(),cookieDomain=".dangdang.com";
function getStorage(a,c){if($.trim(a)){var b="";if(storageFlag&&(!c||"cookie"!=c)){if(0<localStorage.length)for(var d=0;d<localStorage.length;d++)localStorage.getItem(a)&&(b=decodeURIComponent(localStorage.getItem(a)));return b}b=document.cookie.match(RegExp("(^| )"+a+"=([^;]*)(;|$)"));if(null!=b)return unescape(b[2])}return""}
function setStorage(a,c,b){$.trim(a)&&(!storageFlag||b&&"cookie"==b?(b=a+"="+escape(c),days="undefined"==typeof days||0==days?3650:days,a=new Date,a.setTime(a.getTime()+864E5*days),b=b+";domain="+cookieDomain+";path=/;expires="+a.toGMTString(),document.cookie=b):localStorage.setItem(a,encodeURIComponent(c)))}
function delStorage(a,c){if($.trim(a))if(!storageFlag||c&&"cookie"==c){var b=new Date,d=getStorage(a);b.setTime(b.getTime()-1);null!=d&&(document.cookie=a+"="+d+";domain="+cookieDomain+";path=/;expires="+b.toGMTString())}else 0<localStorage.length&&""!=a&&localStorage.removeItem(a)}
function clearStorage(a){if(!storageFlag||a&&"cookie"==a){if(a=document.cookie.match(/[^ =;]+(?=\=)/g))for(var c=a.length-1;0<=c;c--){var b=new Date,d=getStorage(a[c]);b.setTime(b.getTime()-1);document.cookie=a[c]+"="+d+";domain="+cookieDomain+";path=/;expires="+b.toGMTString()}}else localStorage.clear()}
var pop={wrap:null,mask:null,isInitMask:!1,text:"",complete:null,determine:null,ok:null,cancel:null,determine_name:"",ok_name:"",cancel_name:"",speed:0,type:"",popup:function(a){if(!a.text)return!1;this.wrap=a.wrap?$(a.wrap):$(".popup");this.mask=a.mask?$(a.mask):$(".mask");this.isInitMask="boolean"===typeof a.isInitMask?a.isInitMask:!1;this.isFinalMask="boolean"===typeof a.isFinalMask?a.isFinalMask:!1;this.title=a.title?a.title:"\u6e29\u99a8\u63d0\u793a";this.title_show=a.title_show;this.text=a.text;
this.text_align="left"==a.text_align?"left":"right"==a.text_align?"right":"";this.complete="function"===typeof a.complete?a.complete:null;this.determine="function"===typeof a.determine?a.determine:null;this.ok="function"===typeof a.ok?a.ok:null;this.cancel="function"===typeof a.cancel?a.cancel:null;this.determine_name=a.determine_name?a.determine_name:"\u786e\u5b9a";this.ok_name=a.ok_name?a.ok_name:"\u786e\u5b9a";this.cancel_name=a.cancel_name?a.cancel_name:"\u53d6\u6d88";this.speed="number"===typeof a.speed&&
0<a.speed?a.speed:2E3;if(a.type)switch(a.type.toLowerCase()){case "pop":this.type="Pop";break;case "confirm":this.type="Confirm";break;default:this.type="Alert"}else this.type="Alert";this.isInitMask?this.mask.css("display","block"):this.mask.css("display","none");this.wrap.css("display","none");this.wrap.removeClass("Pop Alert Confirm");this.wrap.find(".title").html("<span>"+this.title+"</span>").css("display","block").find("span").css("display","none");this.wrap.addClass(this.type).find(".info").removeClass("left right frame").addClass(this.text_align).html(this.text);
this.wrap.find(".determine").html(this.determine_name).off("click").css("display","none");this.wrap.find(".ok").html(this.ok_name).off("click").css("display","none");this.wrap.find(".cancel").html(this.cancel_name).off("click").css("display","none");"Pop"===this.type?this.openPop():"Confirm"===this.type?this.openConfirm():this.openAlert();this.wrap.css({width:window.innerWidth+"px",height:window.innerHeight+"px",display:"block"})},openPop:function(){var a=this;a.wrap.find(".title").css("display",
"none");setTimeout(function(){a.wrap.css("display","none");a.complete&&a.complete()},a.speed)},openConfirm:function(){var a=this;a.mask.css("display","block");a.title_show="undefined"!==typeof a.title_show?a.title_show?!0:!1:!1;a.title_show&&(a.wrap.find(".title span").css("display","block"),a.wrap.find(".info").addClass("frame"));a.wrap.find(".ok").css("display","block");a.wrap.find(".cancel").css("display","block");a.wrap.find(".ok").on("click",function(){a.isFinalMask?a.mask.css("display","block"):
a.mask.css("display","none");a.wrap.css("display","none");a.ok&&a.ok();a.complete&&a.complete()});a.wrap.find(".cancel").on("click",function(){a.isFinalMask?a.mask.css("display","block"):a.mask.css("display","none");a.wrap.css("display","none");a.cancel&&a.cancel();a.complete&&a.complete()})},openAlert:function(){var a=this;a.mask.css("display","block");a.title_show="undefined"!==typeof a.title_show?a.title_show?!0:!1:!0;a.title_show?a.wrap.find(".title span").css("display","block"):a.wrap.find(".info").addClass("frame");
a.wrap.find(".determine").css("display","block");a.wrap.find(".determine").on("click",function(){a.isFinalMask?a.mask.css("display","block"):a.mask.css("display","none");a.wrap.css("display","none");a.determine&&a.determine();a.complete&&a.complete()})}},$_GET=function(){var a=window.document.location.href.toString().split("?");if("string"==typeof a[1]){-1!=a[1].indexOf("#")?(a=a[1].split("#"),a=a[0].split("&")):a=a[1].split("&");for(var c={},b=0,d=a.length;b<d;b++){var f=a[b].split("=");c[f[0]]=
f[0]?f[1]:""}return c}return{}}();function is_login(){return""!==(getStorage("MDD_sid","cookie")&&getStorage("MDD_token","cookie"))?!0:!1}
var appBridge={_connectWebViewJavascriptBridge:function(a){window.WebViewJavascriptBridge?a(WebViewJavascriptBridge):document.addEventListener("WebViewJavascriptBridgeReady",function(){a(WebViewJavascriptBridge)},!1)},iosPageShow:function(){window.onpageshow=function(a){a.persisted&&window.location.reload()}},setNavTitle:function(a,c){"function"!==typeof c&&(c=function(){});this._connectWebViewJavascriptBridge(function(b){b.callHandler("setNavTitle",a,c)})},setNavBack:function(a,c){"function"===typeof a?
a="("+a.toString()+")()":"string"!==typeof a&&(a=a.toString());"function"!==typeof c&&(c=function(){});this._connectWebViewJavascriptBridge(function(b){b.callHandler("setNavBack",a,c)})},setBackButton:function(a,c){"function"===typeof a?a="("+a.toString()+")()":"string"!==typeof a&&(a=a.toString());"function"!==typeof c&&(c=function(){});this._connectWebViewJavascriptBridge(function(b){b.callHandler("setBackButton",a,c)})},setNavRightButtons:function(a){this._connectWebViewJavascriptBridge(function(c){c.callHandler("setNavRightButtons",
a,function(){})})},standardMethod:function(a,c,b){if("string"!==typeof a)return!1;"function"===typeof c?c="("+c.toString()+")()":"string"!==typeof c&&(c=c.toString());"function"!==typeof b&&(b=function(){});this._connectWebViewJavascriptBridge(function(d){d.callHandler(a,c,b)})}},phoneBrowser={versions:function(){var a=navigator.userAgent;return{trident:-1<a.indexOf("Trident"),presto:-1<a.indexOf("Presto"),webKit:-1<a.indexOf("AppleWebKit"),gecko:-1<a.indexOf("Gecko")&&-1==a.indexOf("KHTML"),mobile:!!a.match(/AppleWebKit.*Mobile.*/),
ios:!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<a.indexOf("Android")||-1<a.indexOf("Linux"),iPhone:-1<a.indexOf("iPhone"),iPad:-1<a.indexOf("iPad"),webApp:-1==a.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()},lazyLoadImg={init:function(){$(window).off("scroll",this.loadImages).on("scroll",this.loadImages)},loadImages:function(){var a=this;$(".lazy").each(function(){var c=$(this).offset().top,b=c+$(this).height(),d=$(window).scrollTop(),f=d+window.innerHeight;
if(c>=d&&b<=f||c<d&&b>d||c<f&&b>f||c<d&&b>f)$(this).data("lazytimes")||$(this).data("lazytimes",1),a._images($(this))})},coreLoadImages:function(a){a.data("lazytimes")||a.data("lazytimes",1);this._images(a)},_images:function(a){var c=new Image,b=a.attr("imgsrc");b?(a.removeClass("lazy"),c.onload=function(){!0==c.complete&&(a.attr("src",b),a.removeAttr("imgsrc"),a.onerror=null,"undefined"!==typeof a.removeData?a.removeData("lazytimes"):a.data("lazytimes",void 0))},c.onerror=function(){if(3>a.data("lazytimes")){var b=
parseInt(a.data("lazytimes"))||1;a.addClass("lazy");a.data("lazytimes",b+1)}else a.removeClass("lazy"),"undefined"!==typeof a.removeData?a.removeData("lazytimes"):a.data("lazytimes",void 0)},c.src=b):a.removeAttr("imgsrc")}},htmlEncode=function(a){var c="",b=null;if(0==a.length)return c;document.getElementById("xssHtmlCode")||(b=document.createElement("div"),b.setAttribute("id","xssHtmlCode"),b.style.display="none",document.body.appendChild(b));b=document.getElementById("xssHtmlCode");b.appendChild(document.createTextNode(a));
c=b.innerHTML;b.innerHTML="";return c},htmlDecode=function(a){var c="",b=null;if(0==a.length)return c;document.getElementById("xssHtmlCode")||(b=document.createElement("div"),b.setAttribute("id","xssHtmlCode"),b.style.display="none",document.body.appendChild(b));b=document.getElementById("xssHtmlCode");b.innerHTML=a;c=b.innerText||b.textContent;b.innerHTML="";return c};
function mobileInfo(){var a=window.navigator.userAgent.toLowerCase(),c="other",b="0.0.0";a.match(/\(i[^;]+;( u;)? cpu.+mac os x/)?-1<a.indexOf("iphone")?(c="iphone",b=a.substr(a.indexOf("iphone; cpu iphone os")+22,6).replace(/;| |[^0-9._]/g,"").replace(/_/g,".")):-1<a.indexOf("ipod")?c="ipod":-1<a.indexOf("ipad")&&(c="ipad",b=a.substr(a.indexOf("ipad; cpu os")+13,6).replace(/;| |[^0-9._]/g,"").replace(/_/g,".")):-1<a.indexOf("android")||-1<a.indexOf("linux")?(c="android",b=a.substr(a.indexOf("android")+
8,6).replace(/;| |[^0-9.]/g,""),""==b&&(b="4.4.0")):-1<a.indexOf("rim tablet os")?(c="blackbery",b=a.substr(a.indexOf("rim tablet os")+14,6).replace(/;| |[^0-9.]/g,"")):-1<a.indexOf("bb10")?(c="blackbery",b="bb10"):a.indexOf("iemobile")&&(c="wp",console.log(a),b=a.substr(a.indexOf("windows phone")+14,6).replace(/;| |[^0-9.]/g,""));return{client:c,version:b}}
function judgeVersion(a,c,b){if(!$_GET.user_client||!$_GET.client_version)return!1;var d=[],f=0,h=0,g=[],g=$_GET.client_version,e=$_GET.user_client.toLowerCase();b&&(d=mobileInfo(),"other"!=d.client&&(g=d.version,e=d.client));d=a.split(".");f=d.length;g=g.split(".");h=g.length;if(e!=c)return!1;if(h<f)for(a=0;a<Number(f-h);a++)g.push("0");for(a=0;a<f;a++){if(Number(g[a])<Number(d[a]))return!1;if(Number(g[a])>Number(d[a])||a==f-1)return!0}}
function dictPrefix(a){var c=a.split("://"),b=["http","https","ftp"];return a?1==c.length?a:judgeVersion("4.9.1","iphone")&&0>b.indexOf(c[0].toLowerCase())?"http://redirect.dangdang.com/"+a:a:null}
function dateFormat(a,c){a=new Date(a.replace(/-/g,"/"));c=c?c:"yyyy-MM-dd hh:mm:ss";var b={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(c)&&(c=c.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in b)RegExp("("+d+")").test(c)&&(c=c.replace(RegExp.$1,1==RegExp.$1.length?b[d]:("00"+b[d]).substr((""+b[d]).length)));return c}
function deepCopyObj(a){var c=a instanceof Array?[]:{},b;for(b in a)c[b]=a[b]instanceof Object||a[b]instanceof Array?deepCopyObj(a[b]):a[b]||0==a[b]?a[b]:"";return c}
function coverMerge(a){function c(a,b,d){for(var e in b)d&&("object"===typeof b[e]&&Object.getPrototypeOf(b[e])==Object.prototype||b[e]instanceof Array)?("object"!==typeof b[e]||Object.getPrototypeOf(b[e])!=Object.prototype||"object"===typeof a[e]&&Object.getPrototypeOf(a[e])==Object.prototype||(a[e]={}),b[e]instanceof Array&&!(a[e]instanceof Array)&&(a[e]=[]),c(a[e],b[e],d)):void 0!==b[e]&&(a[e]=b[e])}var b=!1,d=[].slice.call(arguments,1);"boolean"===typeof a&&(b=a,a=d.shift());d.forEach(function(d){c(a,
d,b)});return a}
function extendMerge(a){function c(a,b,d){for(var e in b)"undefined"===typeof a[e]&&(d&&("object"===typeof b[e]&&Object.getPrototypeOf(b[e])==Object.prototype||b[e]instanceof Array)?("object"!==typeof b[e]||Object.getPrototypeOf(b[e])!=Object.prototype||"object"===typeof a[e]&&Object.getPrototypeOf(a[e])==Object.prototype||(a[e]={}),b[e]instanceof Array&&!(a[e]instanceof Array)&&(a[e]=[]),c(a[e],b[e],d)):void 0!==b[e]&&(a[e]=b[e]))}var b=!1,d=[].slice.call(arguments,1);"boolean"===typeof a&&(b=a,
a=d.shift());d.forEach(function(d){c(a,d,b)});return a}function numberIntegerDecimal(a,c){c=c||2;a="number"===typeof a?a.toFixed(c):isNaN(Number(a))?(0).toFixed(c):Number(a).toFixed(c);a=a.toString().split(".");return{integer:a[0],decimal:a[1]}}
function timeDifference(a,c){var b=c?c:(new Date).getTime();c=a||0;var d=0,f=!1,h=0,g=0,e=0,k=d=0,l=!0;c||(l=!1);l&&(d=b-c,0>d&&(d=Math.abs(d),f=!0),k=d%1E3,d=Math.floor(d/1E3),h=Math.floor(d/86400),g=Math.floor(d%86400/3600),e=Math.floor(d%86400%3600/60),d=Math.floor(d%86400%3600%60));return{future:f,day:h,hour:g,minute:e,second:d,ms:k}}
(function(){var a="undefined"!==typeof ddad?ddad:!1,c=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},b=parseInt(function(a){var b={};return b=window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle}(document.getElementsByTagName("html")[0]).fontSize.replace("px","")),d=!1;0==b%10&&(d=!0);if(a&&!document.getElementById("ddad")){var f=null,a="#ddad{position:fixed;top:150px;right:0;width:12px;z-index:10000;background-color:rgba(166,166,166,.8);color:white !important;font-size:8px !important;word-break;break-all;border-top-left-radius:3px;border-bottom-left-radius:3px;text-align:center !important;padding:3px 0 2px 0 !important;line-height:9px !important;}",
f=null;d&&(b=20/b,a="#ddad{position:fixed;top:"+7.5*b+"rem;right:0;width:"+0.6*b+"rem;z-index:10000;background-color:rgba(166,166,166,.8);color:white !important;font-size:"+0.4*b+"rem !important;word-break;break-all;border-top-left-radius:"+0.15*b+"rem;border-bottom-left-radius:"+0.15*b+"rem;text-align:center !important;padding:"+0.15*b+"rem 0 "+0.1*b+"rem 0 !important;line-height:"+0.4*b+"rem !important;}");f=document.createElement("style");f.type="text/css";f.styleSheet?f.styleSheet.cssText=a:f.appendChild(document.createTextNode(a));
document.body.appendChild(f);f=document.createElement("section");f.innerHTML="\u5e7f<br />\u544a<br />\u00d7";f.setAttribute("id","ddad");document.body.appendChild(f);c(document.getElementById("ddad"),"click",function(){this.style.display="none"})}})();
